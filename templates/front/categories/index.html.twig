{% extends 'base.html.twig' %}

{% block title %}Mes pr√©f√©rences{% endblock %}

{% block body %}
<div class="container-lite">
    <h1 class="title">Mes pr√©f√©rences</h1>
    <div class="categories__grid">
        {% for category in app.user.categories %}
            {{ include('/components/filter.html.twig', { category:category, clicked:true }) }}
        {% else %}
            <p>Vous n'avez pas encore ajout√© de cat√©gorie üò™</p>
        {% endfor %}
    </div>
    <h1 class="title">D√©couvrir d'autres cat√©gories</h1>
    <div class="categories__grid">
        {% for category in categories %}
            {% if not app.user.categories.contains(category) %}
                {{ include('/components/filter.html.twig', { category:category, clicked:false }) }}
            {% endif %}
        {% else %}
            <p>Aucune cat√©gorie existante üò¢</p>
        {% endfor %}
        {% if notyf is defined %}
            <div id="notyf-message" class={{ notyf }}>{{ notyf }}</div>
        {% endif %}
    </div>
</div>

<script>
    function select(label) {
        const filterContainer = document.getElementById('filter-'+label);
        let clicked = filterContainer.classList.contains('filter--clicked');
        if (clicked == false) {
            filterContainer.classList.add('filter__container--clicked');
            filterContainer.classList.add('filter--clicked');
            $.ajax({
                type: 'POST',
                url: '/categories/add/' + label,
            });
            notyf.success('Vous avez ajout√© la cat√©gorie ' + label + ' √† votre liste de pr√©f√©rences !');
            
        } else {
            filterContainer.classList.remove('filter__container--clicked');
            filterContainer.classList.remove('filter--clicked');
            $.ajax({
                type: 'POST',
                url: '/categories/remove/' + label,
            });
            notyf.error('Vous avez supprim√© la cat√©gorie ' + label + ' de votre liste de pr√©f√©rences !');
        }
    }
</script>
{% endblock %}


